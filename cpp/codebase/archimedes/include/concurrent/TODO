Change mutex && cv to sempaphore
